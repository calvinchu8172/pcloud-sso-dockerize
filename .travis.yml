language: ruby
# cache: bundler

addons:
  apt:
    packages:
      - imagemagick 
      - libmagickwand-dev 
      - qt5-default 
      - libqt5webkit5-dev
      - xvfb

rvm:
  - 2.3.3

install:
  - bundle install

script:
  - rename 's/.example//' config/settings/*.example
  - rename 's/.example//' config/*.example
  # - mysqladmin -uroot -h mysql create mycloud_test
  - RAILS_ENV=test bundle exec rake db:migrate db:seed
  - mkdir test-plans
  - xvfb-run -a bundle exec cucumber

before_script:
  - mysql -e 'CREATE DATABASE mycloud_test;'
    
services:
  - mysql
  - redis-server

notifications:
  email: false

branches:
  only:
    - feature/20190821-1-travis-ci-test